\hypertarget{classuORB_1_1Subscription}{}\section{u\+O\+RB\+:\+:Subscription Class Reference}
\label{classuORB_1_1Subscription}\index{u\+O\+R\+B\+::\+Subscription@{u\+O\+R\+B\+::\+Subscription}}


Inheritance diagram for u\+O\+RB\+:\+:Subscription\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=229pt]{db/d59/classuORB_1_1Subscription__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for u\+O\+RB\+:\+:Subscription\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{db/d78/classuORB_1_1Subscription__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classuORB_1_1Subscription_a6afd37f8aa13bc3ffeafd29b7a3d434f}{Subscription} (\hyperlink{uORB_8h_a96af5434ec1acdf24287bd7851b0413f}{O\+R\+B\+\_\+\+ID} id, uint8\+\_\+t instance=0)
\item 
\hyperlink{classuORB_1_1Subscription_a8851d25ec7fc746ed71214cb65500006}{Subscription} (const \hyperlink{structorb__metadata}{orb\+\_\+metadata} $\ast$meta, uint8\+\_\+t instance=0)
\item 
bool \hyperlink{classuORB_1_1Subscription_acb0fbd4b56d5e3c8edca15206e110223}{subscribe} ()
\item 
\mbox{\Hypertarget{classuORB_1_1Subscription_a4228366c28dfaed084710f13e48934be}\label{classuORB_1_1Subscription_a4228366c28dfaed084710f13e48934be}} 
void {\bfseries unsubscribe} ()
\item 
\mbox{\Hypertarget{classuORB_1_1Subscription_af4675ee1722445e07e50d1a984b8d8c0}\label{classuORB_1_1Subscription_af4675ee1722445e07e50d1a984b8d8c0}} 
bool {\bfseries valid} () const
\item 
\mbox{\Hypertarget{classuORB_1_1Subscription_a9c16cd791d522e477bfafbbc09729bc2}\label{classuORB_1_1Subscription_a9c16cd791d522e477bfafbbc09729bc2}} 
bool {\bfseries advertised} ()
\item 
bool \hyperlink{classuORB_1_1Subscription_a788d1848a46abe88a093be9a1f7cb2ca}{updated} ()
\item 
bool \hyperlink{classuORB_1_1Subscription_a2376542413f8b31c20bcbfc1a11b13ea}{update} (void $\ast$dst)
\item 
bool \hyperlink{classuORB_1_1Subscription_a17a37eb5624b409379db434400de4582}{copy} (void $\ast$dst)
\item 
bool \hyperlink{classuORB_1_1Subscription_a47a32a02ea909df267542d4b4ef99115}{Change\+Instance} (uint8\+\_\+t instance)
\item 
\mbox{\Hypertarget{classuORB_1_1Subscription_ab0c5d9ec0df8e62343413302d6e97fa0}\label{classuORB_1_1Subscription_ab0c5d9ec0df8e62343413302d6e97fa0}} 
uint8\+\_\+t {\bfseries get\+\_\+instance} () const
\item 
\mbox{\Hypertarget{classuORB_1_1Subscription_ad7aaf2211cb1a5ec96cdfda9cabac174}\label{classuORB_1_1Subscription_ad7aaf2211cb1a5ec96cdfda9cabac174}} 
unsigned {\bfseries get\+\_\+last\+\_\+generation} () const
\item 
\mbox{\Hypertarget{classuORB_1_1Subscription_a447b0f0a9e4745f3dcc2bcdf2540d940}\label{classuORB_1_1Subscription_a447b0f0a9e4745f3dcc2bcdf2540d940}} 
\hyperlink{structorb__metadata}{orb\+\_\+id\+\_\+t} {\bfseries get\+\_\+topic} () const
\end{DoxyCompactItemize}
\subsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classuORB_1_1Subscription_acfefc1961589348321e83851139512ce}\label{classuORB_1_1Subscription_acfefc1961589348321e83851139512ce}} 
\hyperlink{classuORB_1_1DeviceNode}{Device\+Node} $\ast$ {\bfseries get\+\_\+node} ()
\end{DoxyCompactItemize}
\subsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classuORB_1_1Subscription_a0d3a0c177af4386b4f3d306a1b995dbc}\label{classuORB_1_1Subscription_a0d3a0c177af4386b4f3d306a1b995dbc}} 
\hyperlink{classuORB_1_1DeviceNode}{Device\+Node} $\ast$ {\bfseries \+\_\+node} \{nullptr\}
\item 
unsigned \hyperlink{classuORB_1_1Subscription_a994ab022fce2eb1c47b62444d9c5cca9}{\+\_\+last\+\_\+generation} \{0\}
\item 
\mbox{\Hypertarget{classuORB_1_1Subscription_ab117a8b8e0b79caaf37847e1f208fa7b}\label{classuORB_1_1Subscription_ab117a8b8e0b79caaf37847e1f208fa7b}} 
\hyperlink{uORB_8h_a96af5434ec1acdf24287bd7851b0413f}{O\+R\+B\+\_\+\+ID} {\bfseries \+\_\+orb\+\_\+id} \{O\+R\+B\+\_\+\+I\+D\+::\+I\+N\+V\+A\+L\+ID\}
\item 
\mbox{\Hypertarget{classuORB_1_1Subscription_a96128476244a201e40b2ffe1ae2fee07}\label{classuORB_1_1Subscription_a96128476244a201e40b2ffe1ae2fee07}} 
uint8\+\_\+t {\bfseries \+\_\+instance} \{0\}
\end{DoxyCompactItemize}
\subsection*{Friends}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classuORB_1_1Subscription_a140e44567b16af0d25b0c7f04f2839c7}\label{classuORB_1_1Subscription_a140e44567b16af0d25b0c7f04f2839c7}} 
class {\bfseries Subscription\+Callback}
\item 
\mbox{\Hypertarget{classuORB_1_1Subscription_a1a53a356246a3520bc25153445812f1b}\label{classuORB_1_1Subscription_a1a53a356246a3520bc25153445812f1b}} 
class {\bfseries Subscription\+Callback\+Work\+Item}
\end{DoxyCompactItemize}


\subsection{Detailed Description}


Definition at line 58 of file Subscription.\+hpp.



\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classuORB_1_1Subscription_a6afd37f8aa13bc3ffeafd29b7a3d434f}\label{classuORB_1_1Subscription_a6afd37f8aa13bc3ffeafd29b7a3d434f}} 
\index{u\+O\+R\+B\+::\+Subscription@{u\+O\+R\+B\+::\+Subscription}!Subscription@{Subscription}}
\index{Subscription@{Subscription}!u\+O\+R\+B\+::\+Subscription@{u\+O\+R\+B\+::\+Subscription}}
\subsubsection{\texorpdfstring{Subscription()}{Subscription()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily u\+O\+R\+B\+::\+Subscription\+::\+Subscription (\begin{DoxyParamCaption}\item[{\hyperlink{uORB_8h_a96af5434ec1acdf24287bd7851b0413f}{O\+R\+B\+\_\+\+ID}}]{id,  }\item[{uint8\+\_\+t}]{instance = {\ttfamily 0} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

Constructor


\begin{DoxyParams}{Parameters}
{\em id} & The u\+O\+RB O\+R\+B\+\_\+\+ID enum for the topic. \\
\hline
{\em instance} & The instance for multi sub. \\
\hline
\end{DoxyParams}


Definition at line 68 of file Subscription.\+hpp.


\begin{DoxyCode}
68                                                   :
69         \_orb\_id(\textcolor{keywordtype}{id}),
70         \_instance(instance)
71     \{
72         \hyperlink{classuORB_1_1Subscription_acb0fbd4b56d5e3c8edca15206e110223}{subscribe}();
73     \}
\end{DoxyCode}
\mbox{\Hypertarget{classuORB_1_1Subscription_a8851d25ec7fc746ed71214cb65500006}\label{classuORB_1_1Subscription_a8851d25ec7fc746ed71214cb65500006}} 
\index{u\+O\+R\+B\+::\+Subscription@{u\+O\+R\+B\+::\+Subscription}!Subscription@{Subscription}}
\index{Subscription@{Subscription}!u\+O\+R\+B\+::\+Subscription@{u\+O\+R\+B\+::\+Subscription}}
\subsubsection{\texorpdfstring{Subscription()}{Subscription()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily u\+O\+R\+B\+::\+Subscription\+::\+Subscription (\begin{DoxyParamCaption}\item[{const \hyperlink{structorb__metadata}{orb\+\_\+metadata} $\ast$}]{meta,  }\item[{uint8\+\_\+t}]{instance = {\ttfamily 0} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

Constructor


\begin{DoxyParams}{Parameters}
{\em meta} & The u\+O\+RB metadata (usually from the \hyperlink{uORB_8h_a96af5434ec1acdf24287bd7851b0413f}{O\+R\+B\+\_\+\+I\+D()} macro) for the topic. \\
\hline
{\em instance} & The instance for multi sub. \\
\hline
\end{DoxyParams}


Definition at line 81 of file Subscription.\+hpp.


\begin{DoxyCode}
81                                                                  :
82         \_orb\_id((meta == \textcolor{keyword}{nullptr}) ? ORB\_ID::INVALID : static\_cast<ORB\_ID>(meta->
      \hyperlink{structorb__metadata_a9f5cae5c486a015774b7accc62ca040e}{o\_id})),
83         \_instance(instance)
84     \{
85         \hyperlink{classuORB_1_1Subscription_acb0fbd4b56d5e3c8edca15206e110223}{subscribe}();
86     \}
\end{DoxyCode}


\subsection{Member Function Documentation}
\mbox{\Hypertarget{classuORB_1_1Subscription_a47a32a02ea909df267542d4b4ef99115}\label{classuORB_1_1Subscription_a47a32a02ea909df267542d4b4ef99115}} 
\index{u\+O\+R\+B\+::\+Subscription@{u\+O\+R\+B\+::\+Subscription}!Change\+Instance@{Change\+Instance}}
\index{Change\+Instance@{Change\+Instance}!u\+O\+R\+B\+::\+Subscription@{u\+O\+R\+B\+::\+Subscription}}
\subsubsection{\texorpdfstring{Change\+Instance()}{ChangeInstance()}}
{\footnotesize\ttfamily bool u\+O\+R\+B\+::\+Subscription\+::\+Change\+Instance (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{instance }\end{DoxyParamCaption})}

Change subscription instance 
\begin{DoxyParams}{Parameters}
{\em instance} & The new multi-\/\+Subscription instance \\
\hline
\end{DoxyParams}


Definition at line 93 of file Subscription.\+cpp.


\begin{DoxyCode}
94 \{
95     \textcolor{keywordflow}{if} (instance != \_instance) \{
96         DeviceMaster *device\_master = \hyperlink{classuORB_1_1Manager_a9d829b3ea49d16d03c2fa37ef2bb24a5}{uORB::Manager::get\_instance}()->
      \hyperlink{classuORB_1_1Manager_a083331e24ac4f99ac11a0aab1b1681b4}{get\_device\_master}();
97 
98         \textcolor{keywordflow}{if} (device\_master != \textcolor{keyword}{nullptr}) \{
99             \textcolor{keywordflow}{if} (!device\_master->deviceNodeExists(\_orb\_id, \_instance)) \{
100                 \textcolor{keywordflow}{return} \textcolor{keyword}{false};
101             \}
102 
103             \textcolor{comment}{// if desired new instance exists, unsubscribe from current}
104             unsubscribe();
105             \_instance = instance;
106             \hyperlink{classuORB_1_1Subscription_acb0fbd4b56d5e3c8edca15206e110223}{subscribe}();
107             \textcolor{keywordflow}{return} \textcolor{keyword}{true};
108         \}
109 
110     \} \textcolor{keywordflow}{else} \{
111         \textcolor{comment}{// already on desired index}
112         \textcolor{keywordflow}{return} \textcolor{keyword}{true};
113     \}
114 
115     \textcolor{keywordflow}{return} \textcolor{keyword}{false};
116 \}
\end{DoxyCode}
\mbox{\Hypertarget{classuORB_1_1Subscription_a17a37eb5624b409379db434400de4582}\label{classuORB_1_1Subscription_a17a37eb5624b409379db434400de4582}} 
\index{u\+O\+R\+B\+::\+Subscription@{u\+O\+R\+B\+::\+Subscription}!copy@{copy}}
\index{copy@{copy}!u\+O\+R\+B\+::\+Subscription@{u\+O\+R\+B\+::\+Subscription}}
\subsubsection{\texorpdfstring{copy()}{copy()}}
{\footnotesize\ttfamily bool u\+O\+R\+B\+::\+Subscription\+::copy (\begin{DoxyParamCaption}\item[{void $\ast$}]{dst }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

Copy the struct 
\begin{DoxyParams}{Parameters}
{\em dst} & The u\+O\+RB message struct we are updating. \\
\hline
\end{DoxyParams}


Definition at line 129 of file Subscription.\+hpp.


\begin{DoxyCode}
129 \{ \textcolor{keywordflow}{return} advertised() && \_node->\hyperlink{classuORB_1_1DeviceNode_a89d9a792e1e38e04c65baba20f29d780}{copy}(dst, \hyperlink{classuORB_1_1Subscription_a994ab022fce2eb1c47b62444d9c5cca9}{\_last\_generation}); \}
\end{DoxyCode}
\mbox{\Hypertarget{classuORB_1_1Subscription_acb0fbd4b56d5e3c8edca15206e110223}\label{classuORB_1_1Subscription_acb0fbd4b56d5e3c8edca15206e110223}} 
\index{u\+O\+R\+B\+::\+Subscription@{u\+O\+R\+B\+::\+Subscription}!subscribe@{subscribe}}
\index{subscribe@{subscribe}!u\+O\+R\+B\+::\+Subscription@{u\+O\+R\+B\+::\+Subscription}}
\subsubsection{\texorpdfstring{subscribe()}{subscribe()}}
{\footnotesize\ttfamily bool u\+O\+R\+B\+::\+Subscription\+::subscribe (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

(curr\+\_\+gen$<$(unsigned)\+\_\+node-\/$>$get\+\_\+queue\+\_\+size())?(unsigned)\+\_\+node-\/$>$get\+\_\+queue\+\_\+size()\+:curr\+\_\+gen; 

Definition at line 46 of file Subscription.\+cpp.


\begin{DoxyCode}
47 \{
48     \textcolor{comment}{// check if already subscribed}
49     \textcolor{keywordflow}{if} (\_node != \textcolor{keyword}{nullptr}) \{
50         \textcolor{keywordflow}{return} \textcolor{keyword}{true};
51     \}
52 
53     \textcolor{keywordflow}{if} (\_orb\_id != ORB\_ID::INVALID) \{
54 
55         DeviceMaster *device\_master = \hyperlink{classuORB_1_1Manager_a9d829b3ea49d16d03c2fa37ef2bb24a5}{uORB::Manager::get\_instance}()->
      \hyperlink{classuORB_1_1Manager_a083331e24ac4f99ac11a0aab1b1681b4}{get\_device\_master}();
56 
57         \textcolor{keywordflow}{if} (device\_master != \textcolor{keyword}{nullptr}) \{
58 
59             \textcolor{keywordflow}{if} (!device\_master->deviceNodeExists(\_orb\_id, \_instance)) \{
60                 \textcolor{keywordflow}{return} \textcolor{keyword}{false};
61             \}
62 
63             \hyperlink{classuORB_1_1DeviceNode}{uORB::DeviceNode} *node = device\_master->getDeviceNode(get\_topic(), \_instance);
64 
65             \textcolor{keywordflow}{if} (node != \textcolor{keyword}{nullptr}) \{
66                 \_node = node;
67                 \_node->\hyperlink{classuORB_1_1DeviceNode_abb03278ff4ddd2a50e0f2996e856f2cc}{add\_internal\_subscriber}();
68 
69                 \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} curr\_gen = \_node->published\_message\_count();
70 
71                 \textcolor{comment}{// If there were any previous publications allow the subscriber to read them}
73 \textcolor{comment}{}                \hyperlink{classuORB_1_1Subscription_a994ab022fce2eb1c47b62444d9c5cca9}{\_last\_generation} = curr\_gen - !(curr\_gen<(unsigned)\_node->get\_queue\_size())
      ?(\textcolor{keywordtype}{unsigned})\_node->get\_queue\_size():curr\_gen;
74 
75                 \textcolor{keywordflow}{return} \textcolor{keyword}{true};
76             \}
77         \}
78     \}
79 
80     \textcolor{keywordflow}{return} \textcolor{keyword}{false};
81 \}
\end{DoxyCode}
\mbox{\Hypertarget{classuORB_1_1Subscription_a2376542413f8b31c20bcbfc1a11b13ea}\label{classuORB_1_1Subscription_a2376542413f8b31c20bcbfc1a11b13ea}} 
\index{u\+O\+R\+B\+::\+Subscription@{u\+O\+R\+B\+::\+Subscription}!update@{update}}
\index{update@{update}!u\+O\+R\+B\+::\+Subscription@{u\+O\+R\+B\+::\+Subscription}}
\subsubsection{\texorpdfstring{update()}{update()}}
{\footnotesize\ttfamily bool u\+O\+R\+B\+::\+Subscription\+::update (\begin{DoxyParamCaption}\item[{void $\ast$}]{dst }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

Update the struct 
\begin{DoxyParams}{Parameters}
{\em dst} & The u\+O\+RB message struct we are updating. \\
\hline
\end{DoxyParams}


Definition at line 123 of file Subscription.\+hpp.


\begin{DoxyCode}
123 \{ \textcolor{keywordflow}{return} \hyperlink{classuORB_1_1Subscription_a788d1848a46abe88a093be9a1f7cb2ca}{updated}() && \_node->\hyperlink{classuORB_1_1DeviceNode_a89d9a792e1e38e04c65baba20f29d780}{copy}(dst, \hyperlink{classuORB_1_1Subscription_a994ab022fce2eb1c47b62444d9c5cca9}{\_last\_generation}); \}
\end{DoxyCode}
\mbox{\Hypertarget{classuORB_1_1Subscription_a788d1848a46abe88a093be9a1f7cb2ca}\label{classuORB_1_1Subscription_a788d1848a46abe88a093be9a1f7cb2ca}} 
\index{u\+O\+R\+B\+::\+Subscription@{u\+O\+R\+B\+::\+Subscription}!updated@{updated}}
\index{updated@{updated}!u\+O\+R\+B\+::\+Subscription@{u\+O\+R\+B\+::\+Subscription}}
\subsubsection{\texorpdfstring{updated()}{updated()}}
{\footnotesize\ttfamily bool u\+O\+R\+B\+::\+Subscription\+::updated (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

Check if there is a new update. 

Definition at line 117 of file Subscription.\+hpp.


\begin{DoxyCode}
117 \{ \textcolor{keywordflow}{return} advertised() && (\_node->published\_message\_count() != \hyperlink{classuORB_1_1Subscription_a994ab022fce2eb1c47b62444d9c5cca9}{\_last\_generation}); \}
\end{DoxyCode}


\subsection{Member Data Documentation}
\mbox{\Hypertarget{classuORB_1_1Subscription_a994ab022fce2eb1c47b62444d9c5cca9}\label{classuORB_1_1Subscription_a994ab022fce2eb1c47b62444d9c5cca9}} 
\index{u\+O\+R\+B\+::\+Subscription@{u\+O\+R\+B\+::\+Subscription}!\+\_\+last\+\_\+generation@{\+\_\+last\+\_\+generation}}
\index{\+\_\+last\+\_\+generation@{\+\_\+last\+\_\+generation}!u\+O\+R\+B\+::\+Subscription@{u\+O\+R\+B\+::\+Subscription}}
\subsubsection{\texorpdfstring{\+\_\+last\+\_\+generation}{\_last\_generation}}
{\footnotesize\ttfamily unsigned u\+O\+R\+B\+::\+Subscription\+::\+\_\+last\+\_\+generation \{0\}\hspace{0.3cm}{\ttfamily [protected]}}

last generation the subscriber has seen 

Definition at line 150 of file Subscription.\+hpp.



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/home/andressanchez/\+Escritorio/\+G\+I\+T/project\+\_\+template/src/modules/u\+O\+R\+B/\hyperlink{Subscription_8hpp}{Subscription.\+hpp}\item 
/home/andressanchez/\+Escritorio/\+G\+I\+T/project\+\_\+template/src/modules/u\+O\+R\+B/\hyperlink{Subscription_8cpp}{Subscription.\+cpp}\end{DoxyCompactItemize}
